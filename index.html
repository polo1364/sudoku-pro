<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sudoku æ•¸ç¨éŠæˆ² Pro+</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: "Microsoft JhengHei", "PingFang TC", "Helvetica Neue", sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.container {
  background: white;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  padding: 30px;
  max-width: 500px;
  width: 100%;
}

h1 {
  color: #2d3748;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 20px;
  text-align: center;
  letter-spacing: 1px;
}

.info-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #f7fafc;
  padding: 15px 20px;
  border-radius: 12px;
  margin-bottom: 20px;
  border: 2px solid #e2e8f0;
}

#timer {
  font-size: 18px;
  font-weight: 700;
  color: #2d3748;
}

.hints-display {
  font-size: 18px;
  font-weight: 700;
  color: #667eea;
}

#controls {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 20px;
}

select, button {
  padding: 12px 16px;
  font-size: 16px;
  font-weight: 600;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: inherit;
}

select {
  background: #edf2f7;
  color: #2d3748;
  border: 2px solid #cbd5e0;
  grid-column: span 2;
}

button {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

button:active {
  transform: translateY(0);
}

#hintBtn {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  grid-column: span 2;
}

#board {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  gap: 0;
  margin: 0 auto 20px;
  border: 4px solid #2d3748;
  border-radius: 8px;
  overflow: hidden;
  background: #2d3748;
}

.cell {
  aspect-ratio: 1;
  width: 100%;
  text-align: center;
  font-size: 20px;
  font-weight: 700;
  border: 1px solid #cbd5e0;
  outline: none;
  background: white;
  color: #2d3748;
  transition: all 0.2s ease;
}

.cell:focus {
  background: #edf2f7;
  border-color: #667eea;
  z-index: 10;
}

.cell:disabled {
  background: #e2e8f0;
  color: #1a202c;
  font-weight: 800;
}

.cell[data-row="2"],
.cell[data-row="5"] { 
  border-bottom: 3px solid #2d3748; 
}

.cell[data-col="2"],
.cell[data-col="5"] { 
  border-right: 3px solid #2d3748; 
}

#message {
  text-align: center;
  font-size: 16px;
  font-weight: 700;
  color: #2d3748;
  min-height: 24px;
  padding: 10px;
  background: #f7fafc;
  border-radius: 8px;
  border: 2px solid #e2e8f0;
}

@media (max-width: 600px) {
  .container { padding: 20px; }
  h1 { font-size: 24px; }
  .cell { font-size: 18px; }
  button, select { font-size: 15px; padding: 10px 12px; }
  .info-bar { flex-direction: column; gap: 10px; }
}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ§© Sudoku æ•¸ç¨éŠæˆ² Pro+</h1>
  
  <div class="info-bar">
    <div id="timer">æ™‚é–“ï¼š00:00</div>
    <div class="hints-display">ğŸ’¡ æç¤ºï¼š<span id="hintsCount">6</span></div>
  </div>

  <div id="controls">
    <select id="difficulty">
      <option value="easy">ç°¡å–®</option>
      <option value="medium">ä¸­ç­‰</option>
      <option value="hard">å›°é›£</option>
    </select>
    <button onclick="newGame()">æ–°é¡Œç›®</button>
    <button id="hintBtn" onclick="getHint()">ğŸ’¡ ä½¿ç”¨æç¤º</button>
    <button onclick="checkBoard()">æª¢æŸ¥ç­”æ¡ˆ</button>
    <button onclick="resetGame()">é‡æ–°é–‹å§‹</button>
  </div>

  <div id="board"></div>
  <div id="message"></div>
</div>

<script>
let puzzle=[], solution=[], hintsLeft=6, timerInterval, startTime;
const deepCopy=b=>JSON.parse(JSON.stringify(b));

function isSafe(board,row,col,num){
  for(let i=0;i<9;i++)
    if(board[row][i]===num||board[i][col]===num)return false;
  const sr=Math.floor(row/3)*3,sc=Math.floor(col/3)*3;
  for(let i=0;i<3;i++)
    for(let j=0;j<3;j++)
      if(board[sr+i][sc+j]===num)return false;
  return true;
}

function solve(board){
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      if(board[r][c]===0){
        for(let n=1;n<=9;n++){
          if(isSafe(board,r,c,n)){
            board[r][c]=n;
            if(solve(board))return true;
            board[r][c]=0;
          }
        }
        return false;
      }
    }
  }
  return true;
}

function generateSudoku(difficulty){
  let board=Array.from({length:9},()=>Array(9).fill(0));
  solve(board);
  const solved=deepCopy(board);
  const removeMap={easy:35,medium:45,hard:52};
  let removeCount=removeMap[difficulty]||45;
  let attempts=0;
  while(removeCount>0 && attempts<200){
    attempts++;
    let r=Math.floor(Math.random()*9),c=Math.floor(Math.random()*9);
    if(board[r][c]!==0){
      board[r][c]=0;
      removeCount--;
    }
  }
  return {puzzle:board,solution:solved};
}

function drawBoard(){
  const board=document.getElementById("board");
  board.innerHTML="";
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      const cell=document.createElement("input");
      cell.className="cell";
      cell.type="text";
      cell.maxLength=1;
      cell.dataset.row=r;cell.dataset.col=c;
      const val=puzzle[r][c];
      if(val!==0){cell.value=val;cell.disabled=true;}
      else{
        const key=`cell_${r}_${c}`;
        const saved=localStorage.getItem(key);
        if(saved)cell.value=saved;
        cell.addEventListener("input",onInput);
      }
      board.appendChild(cell);
    }
  }
}

function onInput(e){
  const cell=e.target;
  const v=cell.value.replace(/[^1-9]/g,"");
  cell.value=v;
  localStorage.setItem(`cell_${cell.dataset.row}_${cell.dataset.col}`,v);
  if(v && v!=solution[cell.dataset.row][cell.dataset.col])
    cell.style.background="#fee";
  else cell.style.background="white";
}

function getCell(r,c){
  return document.querySelector(`.cell[data-row='${r}'][data-col='${c}']`);
}

function updateHintDisplay(){
  document.getElementById("hintsCount").textContent = hintsLeft;
}

function getHint(){
  if(hintsLeft<=0){
    document.getElementById("message").textContent="âŒ æç¤ºæ¬¡æ•¸å·²ç”¨å®Œ";
    return;
  }
  let empties=[];
  for(let r=0;r<9;r++)for(let c=0;c<9;c++){
    const input=getCell(r,c);
    if(!input.disabled && input.value==="")empties.push({r,c});
  }
  if(empties.length===0){
    document.getElementById("message").textContent="âœ… æ²’æœ‰å¯æç¤ºçš„ç©ºæ ¼ï¼";
    return;
  }
  const pick=empties[Math.floor(Math.random()*empties.length)];
  const cell=getCell(pick.r,pick.c);
  cell.value=solution[pick.r][pick.c];
  cell.style.background="#fffacd";
  hintsLeft--;
  updateHintDisplay();
  document.getElementById("message").textContent = `ğŸ’¡ å·²ä½¿ç”¨æç¤ºï¼Œå‰©é¤˜ ${hintsLeft} æ¬¡`;
}

function checkBoard(){
  let correct=true;
  document.querySelectorAll(".cell").forEach(cell=>{
    const r=cell.dataset.row,c=cell.dataset.col;
    if(!cell.disabled){
      if(Number(cell.value)!==solution[r][c]){
        correct=false;
        cell.style.background="#fee";
      }
      else cell.style.background="#d4edda";
    }
  });
  const msg=document.getElementById("message");
  msg.textContent=correct?"ğŸ‰ æ­å–œå®Œæˆï¼ç­”æ¡ˆå…¨éƒ¨æ­£ç¢ºï¼":"âŒ é‚„æœ‰éŒ¯èª¤ï¼Œè«‹ç¹¼çºŒåŠªåŠ›";
  if(correct){clearInterval(timerInterval);localStorage.clear();}
}

function resetGame(){
  hintsLeft = 6;
  updateHintDisplay();
  document.querySelectorAll(".cell").forEach(cell=>{
    if(!cell.disabled){
      cell.value="";
      cell.style.background="white";
      localStorage.removeItem(`cell_${cell.dataset.row}_${cell.dataset.col}`);
    }
  });
  startTimer();
  document.getElementById("message").textContent="ğŸ”„ å·²é‡æ–°é–‹å§‹ï¼Œæç¤ºæ¬¡æ•¸å·²é‡ç½®";
}

function newGame(){
  const diff=document.getElementById("difficulty").value;
  const data=generateSudoku(diff);
  puzzle=data.puzzle;solution=data.solution;
  localStorage.clear();
  hintsLeft = 6;
  drawBoard();
  updateHintDisplay();
  startTimer();
  const diffText={easy:"ç°¡å–®",medium:"ä¸­ç­‰",hard:"å›°é›£"};
  document.getElementById("message").textContent=`ğŸ® æ–°é¡Œç›®å·²ç”Ÿæˆï¼ˆé›£åº¦ï¼š${diffText[diff]}ï¼‰`;
}

function startTimer(){
  clearInterval(timerInterval);
  startTime=Date.now();
  timerInterval=setInterval(()=>{
    const elapsed=Math.floor((Date.now()-startTime)/1000);
    const m=String(Math.floor(elapsed/60)).padStart(2,"0");
    const s=String(elapsed%60).padStart(2,"0");
    document.getElementById("timer").textContent=`æ™‚é–“ï¼š${m}:${s}`;
  },1000);
}

newGame();
</script>
</body>
</html>

